[WinEventLog]
renderXml = true

# ---------------------
#   Security channel
# ---------------------

[WinEventLog://Security]
disabled = 0
whitelist1 = EventCode=%^(1100|1101|1102|1104|1105|1107|1108|4608|4609|4610|4611|4614|4616|4621|4622|4624|4625|4648|4649|4656|4664|4672|4675|4688|4697|4698|4699|4700|4701|4702|4703|4704|4705|4706|4707|4713|4715|4716|4717|4718|4719|4720|4722|4723|4724|4725|4726|4727|4728|4729|4730|4731|4732|4733|4734|4735|4737|4738|4739|4740|4741|4742|4743|4744|4745|4746|4747|4748|4749|4750|4751|4752|4753|4754|4755|4756|4757|4758|4759|4760|4761|4762|4763||4764|4765|4766|4767|4768|4769|4771|4772|4773|4777|4780|4781|4782|4794|4797|4798|4799|4817|4820|4821|4822|4823|4824|4825|4830|4864|4865|4866|4867|4868|4869|4870|4871|4872|4873|4874|4875|4876|4877|4878|4879|4880|4881|4882|4883|4884|4885|4886|4887|4888|4889|4890|4891|4892|4893|4894|4895|4896|4897|4898|4899|4900|4902|4904|4905|4906|4907|4908|4912|4928|4929|4930|4931|4934|4935|4936|4937|4964|5038|5120|5121|5122|5123|5124|5125|5126|5127|5136|5137|5138|5139|5141|5142|5143|5144|5148|5149|5168|5169|5170|5376|5377|5378|5379|5381|5382|6272|6273|6274|6275|6276|6277|6278|6279|6280|6281|6410|6416|6419|6420|6421|6422|6423|6424)$%
whitelist2 = EventCode=%^4776$% Keywords=%^Audit Failure$%
whitelist3 = EventCode=%^(4661|4662|4663)$% TaskCategory=%^(Directory Service Access|Kernel Object|SAM)$%

# ----------------------
#    System channel 
# ----------------------

[WinEventLog://System]
disabled = 0
whitelist1 = SourceName=%(EventLog|Microsoft-Windows-Eventlog|Microsoft-Windows-Audit-CVE|Microsoft-Windows-DistributedCOM|Microsoft-Windows-GroupPolicy|Microsoft-Windows-Kernel-General|Microsoft-Windows-Kernel-PnP|Microsoft-Windows-Kernel-Power|Microsoft-Windows-Time-Service|Microsoft-Windows-WER-SystemErrorReporting|Microsoft-Windows-WindowsUpdateClient|Microsoft-Windows-Wininit|NETLOGON|Service Control Manager|User32|Kerberos-Key-Distribution-Center|Security-Kerberos|NPS|RemoteAccess|BugCheck|Microsoft-Windows-Resource-Exhaustion-Detector|FilterManager|Microsoft-Windows-Hyper-V-VmSwitch)%

# ----------------------
#  Application channel 
# ----------------------

[WinEventLog://Application]
disabled = 0
whitelist1 = SourceName=%Search-ProfileNotify% EventCode=%1%
whitelist2 = SourceName=%ESENT% EventCode=%(216|325|326|327|637)%
whitelist3 = SourceName=%(Application Error|Application Hang|Windows Error Reporting|Docker|MsiInstaller|Quick Assist|Trend Micro Apex One Server|Windows Server Update Services|MSExchange.*|Veeam.*)%

# ------------------
#  74 - SQL Server
# ------------------
whitelist5 = SourceName=%MSSQL\$.*% EventCode=%^(15268|15281|15457|17199|17200|17201|17202|17810|18401|18451|18453|18454|18455|18456|18456|18461|18462|18463|18464|18465|18466|18467|18468|18470|18471|18486|18487|18488|26022|28046|28047|28048|33002|33090|33205|49904)$%

# ------------------
#  40 - PowerShell
# ------------------

[WinEventLog://Windows PowerShell]
disabled = 1
whitelist = 600, 800

[WinEventLog://Microsoft-Windows-PowerShell/Operational]
disabled = 0
whitelist = 4103, 4104

# PowerShell Core (v6 or higher)
[WinEventLog://PowerShellCore/Operational]
disabled = 0
whitelist = 4103, 4104


# -----------------------
#    62 - DNS Server
# -----------------------

[WinEventLog://DNS Server]
disabled = 0
whitelist = 150,770,6004

[WinEventLog://Microsoft-Windows-DNSServer/Audit]
disabled = 0
whitelist = 512, 513, 514, 515, 516, 517, 518, 522, 523, 537, 540, 541, 542, 543, 548, 549, 550, 551, 555, 556, 557, 565, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582

# ---------------------------
#    71 - Exchange Server
# ---------------------------

[WinEventLog://MSExchange Management]
disabled = 0
whitelist = 1, 6


# --------------------------
#   60 - DC authentication
# --------------------------

[WinEventLog://Microsoft-Windows-Authentication/AuthenticationPolicyFailures-DomainController]
disabled = 0
whitelist = 101,105,106,305,306

[WinEventLog://Microsoft-Windows-Authentication/ProtectedUser-Client]
disabled = 0
whitelist = 104,304

[WinEventLog://Microsoft-Windows-Authentication/ProtectedUserFailures-DomainController]
disabled = 0
whitelist = 100,104

[WinEventLog://Microsoft-Windows-Authentication/ProtectedUserSuccesses-DomainController]
disabled = 0
whitelist = 303
[WinEventLog://Directory Service]
disabled = 0
whitelist = 1138,1174,1644,2946,2947

[WinEventLog://Microsoft-Windows-Kerberos-Key-Distribution-Center/Operational]
disabled = 0
whitelist = 302

# --------------------------
#   50 - Authentication
# --------------------------

[WinEventLog://Microsoft-Windows-NTLM/Operational]
disabled = 1
whitelist1 = 8001,8002,8003,8004

[WinEventLog://Microsoft-Windows-LSA/Operational]
disabled = 1

# -------------------------------
#  11.1 - Remote management: RDP
# -------------------------------

[WinEventLog://Microsoft-Windows-RemoteDesktopServices-RdpCoreTS/Operational]
disabled = 0
whitelist = 104,131,140,168,169

[WinEventLog://Microsoft-Windows-TerminalServices-LocalSessionManager/Operational]
disabled = 0
whitelist = 21,23,24,25,40

[WinEventLog://Microsoft-Windows-TerminalServices-RDPClient/Operational]
disabled = 0
whitelist = 1024,1029

[WinEventLog://Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational]
disabled = 0
whitelist = 1149,20503, 20504, 20506, 20507, 20508, 20509, 20510, 20511, 20512, 20513, 20514, 20522

[WinEventLog://Microsoft-Windows-TerminalServices-Gateway/Operational]
disabled = 0

# ------------------------------------
#  11.2 - Remote management: SSH/WinRM
# ------------------------------------

[WinEventLog://Microsoft-Windows-WinRM/Operational]
disabled = 0
whitelist = 6,91,169

[WinEventLog://OpenSSH/Operational]
disabled = 0

# ------------------
#    32 - Printer
# ------------------

[WinEventLog://Microsoft-Windows-PrintService/Admin]
disabled = 0
whitelist = 354,808,823

[WinEventLog://Microsoft-Windows-PrintService/Operational]
disabled = 0
whitelist = 307,848,849


# ----------------------------
#   21 - Software & updates
# ----------------------------

[WinEventLog://Microsoft-Windows-Application-Experience/Program-Compatibility-Assistant]
disabled = 0
whitelist = 17

[WinEventLog://Microsoft-Windows-Application-Experience/Program-Inventory]
disabled = 0
whitelist = 903,904,907,908

[WinEventLog://Microsoft-Windows-Application-Experience/Program-Telemetry]
disabled = 0
whitelist = 500

[WinEventLog://Microsoft-Windows-Shell-Core/AppDefaults]
disabled = 0
whitelist = 62443

[WinEventLog://Microsoft-Windows-Shell-Core/Operational]
disabled = 0
whitelist = 9707, 9708, 28115

[WinEventLog://OAlerts]
disabled = 0
whitelist = 300

[WinEventLog://Microsoft-Windows-WindowsUpdateClient/Operational]
disabled = 0
whitelist = 41

[WinEventLog://Setup]
disabled = 0
whitelist1 = SourceName=%Microsoft-Windows-Servicing% EventCode=%^(2|4|7|8|9|10|13|14)$%

[WinEventLog://Microsoft-Windows-AppModel-Runtime/Admin]
disabled = 0
whitelist1 = 201

[WinEventLog://Microsoft-Windows-AppXDeploymentServer/Operational]
disabled = 0
whitelist1 = 400, 401, 441, 442, 453, 454, 478, 854

[WinEventLog://Microsoft-Windows-AppXDeployment/Operational]
disabled = 0
whitelist1 = 327

[WinEventLog://Key Management Service]
disabled = 1

[WinEventLog://Microsoft-Windows-Time-Service/Operational]
disabled = 0
whitelist1 = 261

# ------------------------
#  31 - System security
# ------------------------

[WinEventLog://Microsoft-Windows-AppLocker/EXE and DLL]
disabled = 0
whitelist = 8002,8003,8004

[WinEventLog://Microsoft-Windows-AppLocker/MSI and Script]
disabled = 0
whitelist = 8005,8006,8007

[WinEventLog://Microsoft-Windows-CAPI2/Operational]
disabled = 0
whitelist = 11,30,70,81

[WinEventLog://Microsoft-Windows-CertificateServicesClient-Lifecycle-User/Operational]
disabled = 0
whitelist = 1001,1006,1007

[WinEventLog://Microsoft-Windows-CertificateServicesClient-Lifecycle-System/Operational]
disabled = 0
whitelist = 1001,1006,1007

[WinEventLog://Microsoft-Windows-CodeIntegrity/Operational]
disabled = 0
whitelist = 3001,3002,3003,3004,3033,3063,3065,3066,3077
[WinEventLog://Microsoft-Windows-Windows Defender/Operational]
disabled = 0
whitelist = 1013,1014,1116,1117,1118,1119,1121,1122,3002,3007,5000,5001,5004,5007,5008
[WinEventLog://Microsoft-Windows-BitLocker/BitLocker Management]
disabled = 0
whitelist = 768, 775, 793, 796, 817, 840, 

[WinEventLog://Microsoft-Windows-Security-Mitigations/KernelMode]
disabled = 0
whitelist = 3,10,12

[WinEventLog://Microsoft-Windows-Security-Mitigations/UserMode]
disabled = 0

[WinEventLog://Microsoft-Windows-Crypto-NCrypt/Operational]
disabled = 1


[WinEventLog://Microsoft-Windows-LAPS/Operational]
disabled = 0

# ----------------------------
#   10.1 - Network (generic)
# ----------------------------

[WinEventLog://Microsoft-Windows-Windows Firewall With Advanced Security/Firewall]
disabled = 0
whitelist = 2002,2003,2004,2005,2006

[WinEventLog://Microsoft-Windows-WinINet-Config/ProxyConfigChanged]
disabled = 0
whitelist = 5600

[WinEventLog://Microsoft-Windows-Winsock-WS2HELP/Operational]
disabled = 0
whitelist = 1,2,3,4

[WinEventLog://Microsoft-Windows-Wired-AutoConfig/Operational]
disabled = 0
whitelist = 15510

[WinEventLog://Microsoft-Windows-Bits-Client/Operational]
disabled = 0
whitelist = 3,4,59,60

[WinEventLog://Microsoft-Windows-NetworkProfile/Operational]
disabled = 0
whitelist = 10000


# ----------------------------
#   10.2 - Network (SMB)
# ----------------------------

[WinEventLog://Microsoft-Windows-SMBServer/Operational]
disabled = 1
whitelist = 1001

[WinEventLog://Microsoft-Windows-SMBServer/Audit]
disabled = 1
whitelist = 3000

[WinEventLog://Microsoft-Windows-SMBClient/Security]
disabled = 0
whitelist = 31010,31017,31018,32000

[WinEventLog://Microsoft-Windows-SMBClient/Operational]
disabled = 1
whitelist = 30622, 30624

[WinEventLog://Microsoft-Windows-SmbClient/Connectivity]
disabled = 0
whitelist = 30803


# -----------------------
#     100 - SYSMON
# -----------------------

[WinEventLog://Microsoft-Windows-Sysmon/Operational]
disabled = 0


# -------------------------
#    22 - Task & Service
# -------------------------

[WinEventLog://Microsoft-Windows-TaskScheduler/Operational]
disabled = 0
whitelist = 106, 110, 141, 200, 201

# -------------------------
#  20 - System activity
# -------------------------

[WinEventLog://Microsoft-Windows-WMI-Activity/Operational]
disabled = 0
whitelist = 5861

[WinEventLog://Microsoft-Windows-Forwarding/Operational]
disabled = 0

[WinEventLog://Microsoft-Windows-EventCollector/Operational]
disabled = 0

[WinEventLog://Microsoft-Windows-GroupPolicy/Operational]
disabled = 1


# -----------------------
#   70 - IIS webserver
# -----------------------

[WinEventLog://Microsoft-IIS-Configuration/Operational]
disabled = 0
whitelist = 29, 50


[WinEventLog://Microsoft-IIS-Configuration/Administrative]
disabled = 0
# !!! EVENT LOG FILE DISABLED PER DEFAULT !!!


# -----------------------
#    75 - ADFS Server
# -----------------------

[WinEventLog://AD FS/Admin]
disabled = 0

[WinEventLog://DRS/Admin]
disabled = 1


# -----------------------
#    76 - DHCP Server
# -----------------------

[WinEventLog://DhcpAdminEvents]
disabled = 0

[WinEventLog://Microsoft-Windows-Dhcp-Server/Operational]
disabled = 0

[WinEventLog://Microsoft-Windows-DhcpNap/Operational]
disabled = 1

# -----------------------
#    77 - Microsoft Advanced Threat Analytics (ATA) - Replace by Defender for Identity / MDI
# -----------------------

[WinEventLog://Microsoft ATA]
disabled = 0


# -------------------------------------------------------------------------------
#   78-Remote Access Services (RAS) / Direct Access / Always On VPN (AOVPN) 
# -------------------------------------------------------------------------------

[WinEventLog://Microsoft-Windows-Base-Filtering-Engine-Connections/Operational]
disabled = 0
# !!! EVENT LOG FILE DISABLED PER DEFAULT !!!
whitelist = 2000

[WinEventLog://Microsoft-Windows-Base-Filtering-Engine-Resource-Flows/Operational]
disabled = 1
# !!! EVENT LOG FILE DISABLED PER DEFAULT !!!

[WinEventLog://Microsoft-Windows-Iphlpsvc/Operational]
disabled = 0
whitelist = 1
# ID 1: IPHTTPS  Connection established
# ID 6: IPHTTPS  Connection disassociated - excluded

[WinEventLog://Microsoft-Windows-WinNat/Oper]
disabled = 0
whitelist = 3


[WinEventLog://ForwardedEvents]
disabled = 0
